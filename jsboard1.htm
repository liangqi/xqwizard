<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=gb_2312-80">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title></title>
</head>

<body>
<script language="JavaScript"><!--
var LeftReady = 0;
--></script><div align="center"><center>

<table border="1">
    <tr>
        <td><div align="center"><center><table border="0"
        cellpadding="0" cellspacing="0"
        background="jsboard/jsboard.gif">
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
            <tr>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
                <td align="center"><img src="jsboard/oo.gif"
                width="24" height="24"></td>
            </tr>
        </table>
        </center></div></td>
    </tr>
    <tr>
        <td align="center"><table border="0">
            <tr>
                <td><input type="button" name="Start"
                value="|&lt;" onmouseup="JavaScript:StartClick()"></td>
                <td><input type="button" name="Back"
                value="&lt;-" onmouseup="JavaScript:BackClick()"></td>
                <td><input type="button" name="Forward"
                value="-&gt;"
                onmouseup="JavaScript:ForwardClick()"></td>
                <td><input type="button" name="End" value="&gt;|"
                onmouseup="JavaScript:EndClick()"></td>
            </tr>
        </table>
        </td>
    </tr>
</table>
</center></div>

<dl>
    <div align="center"><center>
    <dt>Web页面棋盘由《<a
        href="http://www.elephantbase.net/protocol/xqwizard.htm"
        target="_blank">象棋巫师</a>》生成</dt>
    </center></div><div align="center"><center>
    <dt>欢迎访问<a href="http://www.elephantbase.net/"
        target="_blank">www.elephantbase.net</a></dt>
    </center></div><div align="center"><center>
    <dt><script language="JavaScript"><!--
function Char2Digit(Char) {
  switch (Char) {
  case '1':
    return 1;
  case '2':
    return 2;
  case '3':
    return 3;
  case '4':
    return 4;
  case '5':
    return 5;
  case '6':
    return 6;
  case '7':
    return 7;
  case '8':
    return 8;
  case '9':
    return 9;
  default:
    return 0;
  }
}

function Tag2Piece(Tag) {
  switch (Tag) {
  case 0:
    return "oo";
  case 1:
    return "rk";
  case 2:
    return "ra";
  case 3:
    return "rb";
  case 4:
    return "rn";
  case 5:
    return "rr";
  case 6:
    return "rc";
  case 7:
    return "rp";
  case 8:
    return "bk";
  case 9:
    return "ba";
  case 10:
    return "bb";
  case 11:
    return "bn";
  case 12:
    return "br";
  case 13:
    return "bc";
  case 14:
    return "bp";
  }
}

function Char2Tag(Char) {
  switch (Char) {
  case 'K':
    return 1;
  case 'A':
    return 2;
  case 'B':
  case 'E':
    return 3;
  case 'N':
  case 'H':
    return 4;
  case 'R':
    return 5;
  case 'C':
    return 6;
  case 'P':
    return 7;
  case 'k':
    return 8;
  case 'a':
    return 9;
  case 'b':
  case 'e':
    return 10;
  case 'n':
  case 'h':
    return 11;
  case 'r':
    return 12;
  case 'c':
    return 13;
  case 'p':
    return 14;
  default:
    return 0;
  }
}

function ViewFen(ThisPos) {
  j = 1;
  k = 1;
  TempStr = parent.frames[1].FenStr[ThisPos];
  for (i = 0; i < parent.frames[1].FenStr[ThisPos].length; i ++) {
    TempChar = parent.frames[1].FenStr[ThisPos].charAt(i);
    if (TempChar == ' ') {
      break;
    } else if (TempChar == '/') {
      j ++;
      if (j > 10) {
        break;
      }
      k = 1;
    } else if (Char2Digit(TempChar) == 0) {
      if (k <= 9) {
        NewBoard[j][k] = Char2Tag(TempChar);
        k ++;
      }
    } else {
      for (l = 1; l <= Char2Digit(TempChar); l ++) {
        if (k > 9) {
          break;
        }
        NewBoard[j][k] = 0;
        k ++;
      }
    }
  }
  for (i = 1; i <= 10; i ++) {
    for(j = 1; j <= 9; j ++) {
      k = NewBoard[i][j]
      if (OldBoard[i][j] != k) {
        document.images[i * 9 + j - 10].src = "jsboard/" + Tag2Piece(k) + ".gif";
        OldBoard[i][j] = k;
      }
    }
  }
  parent.frames[1].document.links[parent.frames[1].LastPos].style.background = "";
  parent.frames[1].document.links[ThisPos].style.background = "#FFFF00";
  parent.frames[1].LastPos = ThisPos;
}

function StartClick() {
  ViewFen(0);
}

function BackClick() {
  if (parent.frames[1].LastPos > 0) {
    ViewFen(parent.frames[1].LastPos - 1);
  }
}

function ForwardClick() {
  if (parent.frames[1].LastPos < parent.frames[1].MaxMove) {
    ViewFen(parent.frames[1].LastPos + 1);
  }
}

function EndClick() {
  ViewFen(parent.frames[1].MaxMove);
}

var OldBoard = Array(11);
var NewBoard = Array(11);
for (i = 1; i <= 10; i ++) {
  OldBoard[i] = Array(10);
  NewBoard[i] = Array(10);
  for (j = 1; j <= 9; j ++) {
    OldBoard[i][j] = 0;
    NewBoard[i][j] = 0;
  }
}
LeftReady = 1;
if (parent.frames[1].RightReady) {
  ViewFen(0);
}
--></script></dt>
    </center></div>
</dl>
</body>
</html>
